\pdfobjcompresslevel=0
\documentclass[12pt,letterpaper,oneside,final,titlepage]{article}               % define the basic details of our document
\usepackage{amsmath, commath, pgfplots, datetime, color, nicefrac}                         % get the packages we depend on
\usepackage{fullpage}                                                   % increases the dimensions of the page
\usepackage{setspace}                                                   % this package double spaces our document for editing
\usepackage[scientific-notation=true]{siunitx}
\usepackage[backend=biber,style=phys,biblabel=brackets]{biblatex}
\usepackage[margin=0.7in]{geometry} 
\usepackage[version=3]{mhchem}    
\usepackage{braket}
\numberwithin{equation}{section} % numbers equations based on the section they are in

\pgfplotsset{compat=1.8} % this lines forces the package 'pgfplots' to use a specific version so that this document reliably compiles identically across all system

\addbibresource{ref.bib}

\newcommand{\psiT}{\psi_{\textrm{T}}}
\newcommand{\eBHf}{e^{\frac{-\beta\hat{H}}{2}}}
\newcommand{\eBH}{e^{-\beta\hat{H}}}
\newcommand{\eTH}{e^{-\tau\hat{H}}}
\newcommand{\emiHt}{e^{\frac{-i\hat{H}t}{\hbar}}}
\newcommand{\eiHt}{e^{\frac{i\hat{H}t}{\hbar}}}

\newcommand{\expb}[1]{\ensuremath{\exp{\left[ #1 \right]}}}
\renewcommand{\vec}[1]{\mathbf{#1}}
\DeclareMathOperator{\Tr}{Tr}

\begin{document}
    \title{Semi-classical calculations of excited state energies}
    \author{Neil Raymond
           \\ \texttt{ngraymon@uwaterloo.ca}}
    \newdate{date_document_was_written}{5}{1}{2015}
    \date{\displaydate{date_document_was_written}}
    \maketitle

\doublespacing
%The format for the report should be a research proposal, where you outline the nature of your research project, the backgrounds to it from the literature, the techniques you will use for your research, and the results you hope to obtain. Maximum of 10 pages total, including a brief summary (200 words), references, and figures. Text should be double spaced, 12 point type. 

\subsection*{Abstract}
A path integral ground state method is used to calculate inital conditions of a semiclassical initial value representation approach for molecular systems. 
It is hypothesised that this approach will yield accurate energy spectra from which excited state energies can be obtained. 

\section{Introduction}

\subsection{Prelude}
Accurate and efficient measurement of molecular properties, such as energy states, is an area of active research in theoretical chemistry. 
The literature shows many different uses for these accurate measurements, and the benefits provided by obtaining them in a timely manner[cite]. 
There are many different methods for calculating these values. 
We propose a combination of a path integral ground state method and a semiclassical method. 
Classical methods, such as molecular dynamics simulations, are regularly used in commercial environments[cite]. 
Such methods are only adequate when the properties of interest do not exhibit significant quantum effects. 
Quantum mechanical analytical methods give exact results but are very slow or intractable for certain problems. 
These are the key factors driving the interest in semiclassical methods; which are based on computationally efficient compuclassical trajectories, but also incorporate quantum effects. 
Semiclassical methods can be both efficient and accurate for certain problems. \newline
It has been shown that ground state energies, for molecular systems, can be calculated using a path integral ground state method with good accuracy and speed[cite]. 
In the research we propose, we will combine a semiclassical initial value representation technique (SC-IVR) with a path integral 
ground state (PIGS) technique to obtain accurate excited state energies~\cite{issack2007semiclassical}~\cite{schmidt2014inclusion}.

\newpage

\subsection{Hamiltonian}
We are interested in the excited state energies of a molecular system.
Clearly we will encounter the Hamiltonian $\hat{H}$ because it is the operator corresponding to the total energy of the system.
We will restrict our investigation to one dimension. 
For a system of $N$ particles, where $\hat{V}$ is the potential energy operator that describes the interactions between 
all particles of the system, $m_{i}$ is the mass for particle $i$ and $\hat{p}_{i}$ is the momentum operator, the Hamiltonian is:
\begin{align}
    \hat{H} &= \hat{K} + \hat{V}
    \\      &= \sum_{i=1}^{N}\frac{\hat{p}_{i}^2}{2m_{i}} + \hat{V}
\end{align}

But the Hamiltonian in classical mechanics is derived from a Lagrangian. 
The Hamiltonian tells you how to march forward in time, but the time is different in different reference frames. 
So the Hamiltonian is different in different frames, and this type of symmetry is not apparent in the original formulation of quantum mechanics.
The Hamiltonian is a function of the position and momentum at one time, and it tells you the position and momentum a little later. 
The Lagrangian is a function of the position now and the position a little later (or, equivalently for infinitesimal time separations, it is a function of the position and velocity). 


\subsection{Time dependent Schrodinger}
The Schrodinger equation is a partial differential equation that describes how the quantum state of a physical system changes with time. 
The Hamiltonian generates the evolution of quantum states over time. 
The general time-dependent schrodinger equation:
\begin{equation}
    \hat{H}\ket{\psi} = i\hbar\frac{d}{dt}\ket{\psi}
\end{equation}
Knowing the ground state energy of the particles in our system, how do we obtain the excited state energies? 
Using the time[in]dependent Schrodinger equation of course! 
Given a state $\ket{\Psi(t)}$ at some initial time (t = 0), we can solve it to obtain the state at any subsequent time.
\begin{equation}
    \hat{H}\ket{\psi(t)} = i\hbar\dpd{}{t}\ket{\psi(t)}  
\end{equation}

\subsection{Time independent Schrodinger}
The Schrodinger equation describes the (determinisitic) evolution of the wave function of a particle.
It predicts what the probability distributions are, but fundamentally cannot predict the exact result of each measurement.
The time-independent Schrodinger equation describes stationary states. \\
The general form:
\begin{equation}
    \hat{H}\ket{\psi_{n}} = E_{n}\ket{\psi_{n}}
\end{equation}

Given a state $\ket{\psi(t)}$ at some initial time (t = 0) and $H$ being independent of time:
\begin{equation}
    \ket{\psi(t)} = \emiHt\ket{\psi(0)}
\end{equation}
We call $\emiHt$ the 
By the homomorphism property of the functional calculus, the operator $U = \emiHt$ is a unitary operator.
It is the time evolution operator, or propagator, of a closed quantum system. 



\subsection{Path integral formulation}
A description of quantum theory which generalizes the action principle of classical mechanics.
The classical trajectory is replaced with a functional integral over an infinity of possible trajectories to computer a quantum amplitude.
It is manifestly symmetric between time and space, and allows a scientist to easily change coordinates between very different canonical descriptions of the same quantum system. 

SC-IVR has been shown to provide accurate ZPE, and it can directly be extended to the extraction of excited state energies by simply modifing the initial wave function and increasing the correlation time. We use PIGS to modify the initial wave function, without increasing computational time. Meaning SC-IVR is capable of describing essentially all quantum effects that are based on the phase space information of the wave function.
\section{Proposal}
\subsection{Use PIGS to get $\ket{0}$}
ed in finding the expectation value of the energy operator in the ground state. 
This is equivalent to finding expectation values of functions with respect to the path integral distributions, which we can do by using PIGS simulations.
We will use a technique know as the Path Integral Langevin Equation (PILE) thermostat which improves the efficiency of our sampling [cite].
Using LePIGS, we sample from a classical distribution which is in some appropriate sense isomorphic to a ground state quantum system approximately represented
using discretized path integrals. 
We will use the software package Molecular Modelling Toolkit (MMTK), which implements the LePIGS method, to run our simulations.

\subsection{Use HK $\&$ SC-IVR to get dynamics $\emiHt$} 
The properties of interest are the excited state energies of some molecular system. 
Path integral molecular dynamics allows us to simulate a molecular system. 
Given this simulated system how will we obtain the properties of interest?
Correlation functions are versatile functions that can be used to probe dynamical systems.
A correlation function [stuff].
Correlation functions also have the useful property of producing an intensity spectrum after being fourier transformed.
So we can construct a correlation function such that the fourier transform produces an energy spectrum, where the peaks
represent (energy level jumps).
If we know the ground state energy of a molecular system and this correlation function then we would be able to obtain the properties of interest. \\ \\
We can express correlation functions in general as follows:
\begin{equation}
    C(t) = \frac{1}{Z}\Tr[\eBH\hat{B}\eiHt\hat{A}\emiHt]
\end{equation}
Where $\eBH$ is the thermal density operator, $Z = \Tr(\eBH)$ is the canonical partition function 
and $\eiHt\hat{A}\emiHt=\hat{A}(t)$ is the Heisenberg representation of the operator $\hat{A}$.

We are interested in the [name] correlation function so our correlation function is $\braket{\hat{q}(t)\hat{q}}$. 
If we expand:
\begin{align}
    C(t) &= \braket{\hat{q}(t)\hat{q}}
    \\   &= \braket{0|\hat{q}(t)\hat{q}|0}
    \\   &= \braket{0|\eiHt\hat{q}\emiHt\hat{q}|0}
\end{align}
We know that $\hat{H}\ket{\psi_{n}} = E_{n}\ket{\psi_{n}}$ so $\eiHt$ can act on the left and 
then we pull out the constant $e^{\frac{iE_{0}t}{\hbar}}$:\\
We know that $\hat{H}\ket{\psi_{n}} = E_{n}\ket{\psi_{n}}$ so $\bra{0}\eiHt = \bra{0}e^{\frac{iE_{0}t}{\hbar}}$:
\begin{equation}
    C(t) = e^{\frac{iE_{0}t}{\hbar}}\braket{0|\hat{q}\emiHt\hat{q}|0}
\end{equation}
Now we insert two resolutions of the identity
$\int\int \dif q_{A}\dif q_{B} \ket{q_{A}}\bra{q_{A}}\ket{q_{B}}\bra{q_{B}}$
\begin{align}
    C(t) &= e^{\frac{iE_{0}t}{\hbar}}\int\int \dif q_{A}\dif q_{B} 
    \braket{0|q_{A}}\braket{q_{A}|\hat{q}\emiHt\hat{q}|q_{B}}\braket{q_{B}|0}
    \\   &= e^{\frac{iE_{0}t}{\hbar}}\int\int \dif q_{A}\dif q_{B} 
    q_{A}q_{B}\braket{0|q_{A}}\braket{q_{A}|\emiHt|q_{B}}\braket{q_{B}|0}
    \label{eq:cor_ins}
\end{align}

The real-time propagator $\emiHt$ is troublesome because $\emiHt\ket{q_{B}}$ is intractable. 
To overcome this problem we approximate the real-time propagator.
Two widely used approximations to the real-time propagator are the Herman-Kluck propagator and the Van Vleck-GutzWiller propagator.
We chose to use the Herman-Kluck (HK) propagator instead of the Van Vleck-GutzWiller parimarily because:
\begin{enumerate}
    \item The HK propagator is not restricted to small systems based on CT determined by initial and final positions. [cite]b
    \item The HK propagator has the desired property that the coherent states are localized in coordinate $\&$ momentum space. [cite]
\end{enumerate}
The HK propagator:
\begin{equation}\label{eq:HKprop}
    \hat{G}_{HK}(t) = \frac{1}{2\hbar\pi}\int\!\int \!\dif p\,\!\dif q\, 
    \ket{p(t), q(t)}\bra{p,q} R(p(t),q(t))
    \expb{\left(\frac{iS(p(t),q(t))}{\hbar}\right)}
\end{equation}
Substituting the HK propagator into our correlation function~\eqref{eq:cor_ins}:
\begin{equation*}
    C(t) \approx \frac{e^{\frac{iE_{0}t}{\hbar}}}{2\hbar\pi}\int\cdots\int\! \dif p\,\!\dif q\,\!\dif q_{A}\,\!\dif q_{B}\,
    q_{A}q_{B}\braket{0|q_{A}}\braket{q_{A}|p(t), q(t)} \braket{p,q|q_{B}}\braket{q_{B}|0}
    R(p(t),q(t)) \expb{\left(\frac{iS(p(t),q(t))}{\hbar}\right)}
\end{equation*}
For $t=0$
\begin{equation*}
    C(t=0) \approx \frac{1}{2\hbar\pi}\int\cdots\int\! \dif p\,\!\dif q\,\!\dif q_{A}\,\!\dif q_{B}\,
    q_{A}q_{B}\braket{0|q_{A}}\braket{q_{A}|p(t), q(t)} \braket{p,q|q_{B}}\braket{q_{B}|0}
\end{equation*}
\begin{enumerate}
    \item Talk about "fictioious momenta" p and mass $m^{*}$
    \item Talk about two choices $\gamma = \frac{m}{\hbar^{2}\tau}$ and $m^{*} = \frac{m}{P-1}$
    \item Use Euler's equation and the momentum distribution (symmetric around zero) and the fact that sin is odd to make the imaginary part go away
\end{enumerate}
SC-IVR methods are capable of describing essentially all quantum effects that are based on the phase information of the wave function.
The initial value representation (IVR) is used because it does not require solving the boundary-value problem (root search), a severe numerical challenge in a multidimensional system. \\
The purpose of SC in the time domain is to find an appropriate description of the quantum propagator $\emiHt$ 
in terms of classical trajectories which is valid in the asymptotic limit $\lim_{\hbar \to 0}$. \\
It does this by propagating clasical trajectories uniquely defined by their initial conditions.



\section{Preliminary Results}

\subsection*{Harmonic Oscillator}
The primary test case being investigated is a single electron in a one dimensional harmonic oscillator. 
The Hamiltonian of our electron, where $m = \num{0.000548579909}$u (units?): 
\begin{align}
    \hat{H} &= \sum_{i=1}^{N}\frac{\hat{p}_{i}^2}{2m_{i}} + \hat{V} \\
    \hat{H} &= \hat{K}(x) + \hat{V}(x) \\
            &= \frac{p^2}{2m} + \frac{1}{2} m \omega^{2} x^{2} 
\end{align}
We will simulate a one dimensional harmonic oscillator using the mean values of a LePIGS simulation preformed in three dimensions. 
Where $\psiT$ is the approximation to the exact ground state wavefunciton. 
A uniform trial function ($\psiT = 1$) was used due to simplicity of implementation. \\
Here we can see that our initial estimator has some issues:\\
\includegraphics[width=1.0\linewidth]{betaplot.png}
In this graph the line represents the analytically detemined value.
The line plotted represents many different simulations at $t=0$ with increase $\beta$ and constant $tau$.\\
Some of our latest results for the correlation function:\\
\includegraphics[width=1.0\linewidth]{P=1025_1000classicalsteps.pdf}
\begin{enumerate}
    \item Initial issues
    \item Tried to use different estimator
    \item Set momentum to zero
\end{enumerate}

The secondary test case will be an electron in a on dimensional double well. 
Some consideration is required in regards to tunneling effects. SC-IVR has troubles describing coherent barrier tunneling.

\section{Concluding Remarks}
One Major obstacle is the oscillatory nature of the integral. When sampling, the cancellation between positive and negative terms of the integral results in poor statistics. Therefore more trajectories are required to achieve the same degree of accuracy. To addres this problem we are investigating the use of Filinov filtering.


\section{Acknowledgements}
Dmitri Iouchtchenko was a key editor, and contributed significant effort to the mathematical equations presented in this paper. 
Pierre-Nicholas Roy was a key editor and supervisor.

\renewcommand*{\bibfont}{\scriptsize}
\printbibliography
\end{document}